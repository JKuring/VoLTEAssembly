package com.eastcom.volte.data.xdr;

import com.esotericsoftware.kryo.Kryo;
import com.esotericsoftware.kryo.io.Input;
import com.esotericsoftware.kryo.io.Output;

/**
 * Created by linghang.kong on 2016/9/28.
 */
public class MergedXDRSerializerTest {
    public static void main(String[] args) throws Exception {
        String xdr = "337|6318|11|14748543494082735|6|460007944178010|862097037191270|8613917902063|" +
                "27455521|6318|||8618221014947|||1474961869377|1474961915921||1291720010922469723|" +
                "660075442996206297|750147452722697279|750147452722697280|660075442996206304|" +
                "660075442996206308||||||||||||||||||||||||||||||||||||||||||||||||678089844995830575|||||3||||||";
        Kryo kryo = new Kryo();
        MergedXDRSerializer mergedXDRSerializer = new MergedXDRSerializer();
        kryo.register(MergedXDR.class, 12);
        MergedXDRParser mergedXDRParser = new MergedXDRParser();
        MergedXDR mergedXDR = mergedXDRParser.parse(mergedXDRParser.split(xdr));
        Output output = new Output(1000);
        kryo.writeClassAndObject(output, mergedXDR);
        byte[] bytes = output.getBuffer();

//        byte[] bytes = new byte[]{14, 1, -47, 2, 54, 49, 52, -71, 15, 49, 52, 55, 52, 56, 53, 52, 51, 52, 57, 52, 50, 54, 54, 49, 50,
//                -73, 0, 0, 0, 6, -127, -127, 56, 54, 49, 56, 55, 49, 55, 55, 51, 57, 57, 50, -77, -127, -127, 52, 54,
//                48, 48, 48, 52, 51, 53, 48, 54, 55, 55, 52, 55, -72, 51, 53, 51, 51, 52, 52, 48, 55, 49, 54, 49, 56, 53,
//                51, -80, 56, 54, 49, 51, 53, 54, 52, 51, 55, 48, 53, 49, -73, 50, 53, 56, 49, 48, 54, 57, -79, 54, 49, 52,
//                -71, -46, -20, -86, -42, -10, 42, -50, -123, -83, -42, -10, 42, 0, -127, -127, -127, -127, -127, -127, -127,
//                -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, -127, 54, 48, 54, 48, 51, 50, 50, 51, 55,
//                50, 54, 52, 49, 53, 56, 50, 55, -71, 54, 54, 48, 48, 55, 53, 52, 52, 50, 57, 57, 55, 49, 49, 52, 48, 52, -73,
//                54, 54, 48, 48, 55, 53, 52, 52, 50, 57, 57, 55, 49, 49, 52, 51, 53, -78, -127, -127, -127, -127, -127, -127,
//                55, 51, 50, 49, 51, 51, 48, 53, 48, 55, 50, 51, 50, 53, 55, 56, 48, -76, 55, 51, 50, 49, 51, 51, 48, 53, 48,
//                55, 50, 51, 50, 53, 55, 56, 53, -78, -127, -127, -127, -127, -127, -127, 54, 54, 48, 48, 55, 53, 52, 52, 50,
//                57, 57, 55, 49, 49, 52, 51, 57, -71, 54, 54, 48, 48, 55, 53, 52, 52, 50, 57, 57, 55, 49, 49, 52, 52, 53, -76,
//                -127, -127, -127, -127, -127, -127, 54, 52, 50, 48, 54, 49, 48, 52, 48, 55, 50, 57, 52, 54, 52, 50, 49, -77,
//                50, 51, 55, 50, 53, 53, 53, 48, 53, 54, 56, 57, 48, 51, 51, 54, 54, 49, -77, 50, 51, 50, 51, 56, 57, 50, 53,
//                57, 50, 49, 50, 52, 50, 53, 55, 55, 49, -75, -127, -127, -127, -127, 50, 51, 52, 49, 57, 48, 54, 57, 57, 48,
//                54, 51, 51, 55, 52, 50, 50, 52, -77, -127, -127, -127, -127, -127, 55, 53, 48, 49, 52, 55, 52, 53, 50, 55, 50,
//                51, 53, 49, 56, 49, 57, -75, 6, 0, 0, 0, 0, -56, -16, 26, 0};

        Input input = new Input(bytes);
        MergedXDR mergedXDR1 = (MergedXDR) kryo.readClassAndObject(input);
        System.out.println(mergedXDR1.getImsi_caller().length());
        System.out.println(mergedXDR1.getImsi_caller());
    }

}